<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>BioStatistics - 13&nbsp; Uniform Manifold Approximation and Projection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./apply00_intro.html" rel="next">
<link href="./pre01_pca.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pre00_intro.html">Preprocessing of Data</a></li><li class="breadcrumb-item"><a href="./pre02_umap.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Uniform Manifold Approximation and Projection</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">BioStatistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./tidy00_book_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidy Modelling with R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidy01_intro_package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Tidy Modelling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidy02_mult_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Creating multiple models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidy03_hyperparam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tuning hyperparameters and overfitting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat00_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applied bio-statistical methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat01_diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Diversity measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat02_wilcoxon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Wilcoxon test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat03_mult_testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Multiple testing correction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat04_OLS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ordinary Least Squares Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat05_log_reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat06_enet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Elastic Net</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat07_svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat08_bias_var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Bias and Variance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./pre00_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preprocessing of Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pre01_pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Principal Component Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pre02_umap.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Uniform Manifold Approximation and Projection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./apply00_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling of Microbiome Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apply01_model_diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Diversity Measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apply02_model_lin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modelling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apply03_model_non_lin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Modelling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="4">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#session-info" id="toc-session-info" class="nav-link active" data-scroll-target="#session-info"><span class="header-section-number">14</span> Session Info</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pre00_intro.html">Preprocessing of Data</a></li><li class="breadcrumb-item"><a href="./pre02_umap.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Uniform Manifold Approximation and Projection</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Uniform Manifold Approximation and Projection</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Set seed and load packages.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1337</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidymodels"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>tidymodels<span class="sc">::</span><span class="fu">tidymodels_prefer</span>()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"uwot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Load data.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>count_matrix_clr <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_rds</span>(<span class="st">"https://github.com/WilliamH-R/BioStatistics/raw/main/data/count_matrix/count_matrix_clr.rds"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">"NA"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"data/metadata.txt"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Run, chem_administration, ETHNICITY, geo_loc_name,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>         Host_age, host_body_mass_index, Host_disease, host_phenotype, host_sex) <span class="sc">|&gt;</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Sample =</span> Run,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Treatment =</span> chem_administration,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Ethnicity =</span> ETHNICITY,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Location =</span> geo_loc_name,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">Age =</span> Host_age,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">BMI =</span> host_body_mass_index,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Disease_severity =</span> Host_disease,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">EDSS =</span> host_phenotype,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">Sex =</span> host_sex) <span class="sc">|&gt;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Patient_status =</span> <span class="fu">case_when</span>(Disease_severity <span class="sc">==</span> <span class="st">"1HealthyControl"</span> <span class="sc">~</span> <span class="st">"Healthy"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                                    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"MS"</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">EDSS =</span> <span class="fu">as.factor</span>(EDSS),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">EDSS =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(EDSS) <span class="sc">&amp;</span> Disease_severity <span class="sc">==</span> <span class="st">"1HealthyControl"</span> <span class="sc">~</span> <span class="st">"-1"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">is.na</span>(EDSS) <span class="sc">&amp;</span> Disease_severity <span class="sc">!=</span> <span class="st">"1HealthyControl"</span> <span class="sc">~</span> <span class="st">"Unknown"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> EDSS),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">EDSS =</span> <span class="fu">as.factor</span>(EDSS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>iris.data <span class="ot">&lt;-</span> iris[, <span class="fu">grep</span>(<span class="st">"Sepal|Petal"</span>, <span class="fu">colnames</span>(iris))]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>iris.labels <span class="ot">&lt;-</span> iris[, <span class="st">"Species"</span>] <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>iris.umap <span class="ot">&lt;-</span> iris.data <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  uwot<span class="sc">::</span><span class="fu">umap</span>(<span class="at">n_neighbors =</span> <span class="dv">20</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">min_dist =</span> <span class="fl">0.2</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">metric =</span> <span class="st">"euclidean"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(iris.labels) <span class="sc">|&gt;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Species =</span> value)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>iris.umap <span class="sc">|&gt;</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> V2,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> Species)) <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pre02_umap_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>count_matrix_umap <span class="ot">&lt;-</span> count_matrix_clr <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">"Sample"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  uwot<span class="sc">::</span><span class="fu">umap</span>(<span class="at">n_neighbors =</span> <span class="dv">20</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">min_dist =</span> <span class="fl">0.2</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">n_components =</span> <span class="dv">3</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">metric =</span> <span class="st">"euclidean"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Sample"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meta,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"Sample"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>count_matrix_umap <span class="sc">|&gt;</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> V2,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> Patient_status)) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pre02_umap_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seems to be better split when using 3D</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>count_matrix_umap <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  plotly<span class="sc">::</span><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>V1,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="sc">~</span>V2,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">z =</span> <span class="sc">~</span>V3,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="sc">~</span>Patient_status,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"scatter3d"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">mode =</span> <span class="st">"markers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in RColorBrewer::brewer.pal(N, "Set2"): minimal value for n is 3, returning requested palette with 3 different levels
Warning in RColorBrewer::brewer.pal(N, "Set2"): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-e642c15045a438b687eb" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e642c15045a438b687eb">{"x":{"visdat":{"577077e85d37":["function () ","plotlyVisDat"]},"cur_data":"577077e85d37","attrs":{"577077e85d37":{"x":{},"y":{},"z":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"V1"},"yaxis":{"title":"V2"},"zaxis":{"title":"V3"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-0.71411820880153698,1.3478944636227794,0.011382851684302864,-0.11757394305446667,-0.72463628283718151,-1.4360057973025135,0.83851603039524036,0.029929909789771614,-1.1026947163698964,-1.6706516408083729,-0.4577734135744862,1.3490188456418224,-1.2773267888186268,-1.0194570683596424,-0.82356091967800182,-0.57160779467800182,-0.21269055834987682,-1.3665640019533924,-0.41605111590602917,-1.2371046208498768,0.86207273968479115,-0.33095189563015026,-0.16387578479030651,0.42658117779514271,-0.12711259356716198,0.29753473767063099,0.60109117993137318,-0.92844792834499401,1.9894712305905529,0.79198816784641224,-0.39412805072048229,-0.91196938983181042,0.43996313580295521,-0.56496068469265026,-0.039147581970482292,1.8849008417966076,0.58299330242893177,-0.95442792407253307,-0.42388650408962292,-1.2627393864748768,-1.4189712666628651,-0.096360411560326042,-1.5730011128542714,-0.85402032366970104,-0.6482803486941151,-1.2386037968752674],"y":[-0.86162261272731566,-0.16033844257655883,-1.1590955665237024,-0.78903369213405394,-1.0006735732680871,-0.86622218395534301,0.60803266261753297,0.66152950023349977,-1.0291395595199182,-0.40275697017970824,-0.58324937130275512,1.3233732769363806,-1.0128715446120813,-0.24248937870326781,-0.86944846416774535,-1.1074052264815881,-1.3740282466537073,-0.45099453235927367,0.35014553760227418,-0.029965441477926014,0.53127713893589235,0.77994676326450563,-0.55421118046108031,-0.70432476307216429,-1.2684889247542932,-1.384664099467428,-0.063741963160665271,-0.54834465290370726,0.42746539806064821,-0.21730188633266234,-0.83447818065944457,-0.85321954990688109,1.2986287662857459,-1.193635981333883,-0.41789273525539183,-0.17072300220790648,-0.12907151485744262,-0.22680024410548949,-0.59464148784938597,0.69996448253330446,-0.32292417789760375,-1.0666516235000207,0.78739829753574586,-0.7978163173324182,0.55860181544956422,-1.0031559875136926],"z":[-1.5428720137529206,0.66005080729200127,-0.7181182524614167,0.38048118143750909,-1.7079854628496003,-1.376854958241446,1.5355491021223235,-1.3017173430375886,-1.5989676138810944,-0.73261791676805732,-1.4894409796647858,0.42293208628370049,-1.2445269247941804,-1.2135120055131745,-0.71562820882127998,-0.52293497533128974,-0.51727682561205146,-1.1720834395341706,-0.45559603184984443,-1.3128381392412019,-1.2139607092790436,-1.1280575415544343,-0.40118700475023505,-1.2460494658403229,0.40126269846631768,-0.68217665166185615,-1.3241224905900788,0.7893127778120208,0.42424720316602471,-0.24156338185594795,-1.728844704335196,-1.417013706868155,-0.80213123769090888,0.053071914011971977,-0.80357748479173896,0.023896155650155571,1.5265845635481048,0.41829150706006768,0.40494197397901299,0.25883096247388604,-1.187826695149405,0.79653113871289971,-0.08502727956102607,-0.15851694554613349,0.25382178812696221,-0.1379948279313874],"mode":"markers","type":"scatter3d","name":"Healthy","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"frame":null},{"x":[0.79140738018772083,0.030199799621314583,-1.3921968602297596,1.737816605651588,-0.2707159184572987,-1.1123201512453846,2.0390994883420177,0.87894609936496693,-0.77316876879909557,-1.3784229420779042,-1.2203342579958729,0.97124842175266224,-0.030535902893333855,0.32839087017795521,-0.70142957202175182,1.9974019862057872,1.8933523035885997,-1.7513200902102284,-1.0269777440188221,-0.4995214604494862,-0.28091832629421276,-0.56297799578884167,1.3433025217892833,0.88302496441623646,-1.5138427876589589,0.5651595927121349,-0.24824830523708385,1.4524648524167247,-1.3701164387820057,0.68457201489231068,0.39685801037570911,-1.4003688954470448,0.3810165263058849,1.6047122813107677,-0.37507268420436901,0.59419420727512318,-0.93179437152126354,-0.57540246478298229,-1.3616726063845448,2.2437856531979747,-0.55435391894557995,-1.6366626881716542,0.37315538891574818,0.79895380505344349,0.65068987377902943,1.9306943751218029,0.55677965649387318,1.024982247436256,-0.9349777363894276,0.33538130291721302,1.3552863932492443,1.0552938319089122,-0.034947600281029167,2.1434123850705333,-0.27548524371364635,-1.1223232411501698,0.98533228405734974,0.89717272290012318,0.15303781994602161,0.19667891033908802,1.6740081644894786,2.1739356852414318,0.29092386730930286,0.30140188702365833,1.7743118143918224,0.15748003491184193,-0.4061844014284901,0.63101557263156849,-0.080440726196556511,-0.62791081896999401,0.67083910473606068,0.28080633648654896,1.2326400614621349,-0.6768753193972401,1.0712039805295177,0.72170141705295521,-0.1888525151369862,0.66159704693576771,1.577141556823463,-0.82470914355495495,-0.8487035893557362,-1.4864294194338612,-1.6350443028567128,-0.27319070330837292,0.20673349865695911,0.60450533398410755,0.52317121990940052,0.94658068188449818,0.12945822247287708,-1.0168182515261464,-0.072538580810814324,-0.24700852862575573,0.80330160626193958,1.3975446558835216,-0.5926458500979237,-0.27249928942897839,0.3972976542355724,-1.2879888676760487,0.6678216791989513,-1.3086387776491932,1.9514663554074474,-0.30000134936550182,-1.4247514866946034,-0.96087857714870495,1.2578189707638927,0.35776403912326771,-0.031162466919212761,-9.938708522838624e-05,0.37578180798313099,1.2062328196408458,1.1551483012082286,2.1160676813962169,-0.67442151538112682,-1.4757063054201893,-0.79743310443141979,-1.0049478673098378,1.089130196655006,0.5615737772824474,-0.34046193591335339,1.4525668955685802,-1.7087061070559315,0.092776093566627083,0.35559061535617786,0.51255682476779896,-1.6789486073611073,0.51021555432102161,1.6851823664548107,0.42130831249973255,-0.70988198748806042,-1.3337032460329823,1.8920762873532482,-0.19367333880641979,-1.2757112645266346,-0.26274510852077526,0.9952285624386974,1.0113246775510021,-0.62142964831569714,-0.94797345629909557,-1.5290815495608143,0.67121675976535755,1.4730861521603771,-1.1130964421389393,-0.45398446551540417,0.092117104613990364,-0.86878892413356823,-1.5441581868288807,-0.88129540911891979,1.3568628168942638,-0.99659558764675182,-1.3737785481570057,-1.0120908879397206,-0.79307862750270885,-1.332902159607201,-1.1614439152834706,-1.0919010304568104,0.16410234936496693,-1.2736560963747792,-1.5685751103518299,0.58498838909885365,-1.5508672856447987,-0.82521840563991589,0.47483328350803333,0.59908464916965443,2.1742875910641857,2.1971395350339122,-1.2833454274294667,-0.96062108508327526,1.0303008890988536,-0.86140462390163464,1.3838746882321544,1.450026307189674,0.55525187023899036,-0.22623845568874401,1.0839202738644786,1.7832343912961193,1.3547084666135021,-0.10585042468288464,1.3518121577145763,1.2583110667111583,-0.5720312260744862,-0.52332707873561901,0.79747847088596302,-1.2295677327273182,-1.5723001622317128,0.50679949291965443,1.7618959284665294,-1.1634266041872792,-0.80814858905056042,0.64566973217746693,-1.6358291768191151,-1.5002357625124745,1.5292585230710216,-0.27770921221950573,-1.4878103398440174,-0.64533063403347057,-0.9810888432619862,-0.4935562276003651,-1.6460516118166737,-0.44010182849147839,-0.58541223040798229,-1.0056488179323964,-0.95959207049587292,-1.405864920532494,0.01156691082736927,0.29713610180637318,-0.48938294879177135,0.20580175884983021,-1.7083608769533924,-0.33042165271022839,-0.10485192767360729,-1.0544035100100331,-1.3227579259035878,1.240095887267799,-1.3016035222170643,-0.52275010577419323,-1.3467418812868885,0.51684740551731068,-0.60323449603298229,0.95544699200412708,-0.93550416461208385,1.6771133280636974,0.85618761547824818,0.34026697644016224,1.359419617736549,1.2259204722287365,0.65713194378635365,-0.30034562579372448,0.20810106762668568,-1.0227195881960682,1.0543792582394786,-0.93468591204860729,-0.37463780871608776,-0.43659230700710339,-0.84064408770778698,-0.84142228594997448,1.6666219569089122,0.95200232037326771,0.83616999157688099,-1.0201990269778065,-0.00042268267849010499,0.1560724116208263,0.68314436444065052,-0.18749257556179089,0.6801660395505138,-0.89292546740749401,-0.3464920186159901,1.8336217738034435,-1.7605077885744862,-0.42618390551784557,0.25791147717258411,0.89147356518527943,2.0659797526242443,-1.4658081196902089,-0.83458062640407604,1.1484878397824474,1.0151574946286388,-1.4870035313723378,0.32010725506565052,-0.95167848101833385,-1.3499099873659901,-0.32555314532497448,-0.78531476489284557,-1.0700952672121815,-1.3285753392336659,0.95435312756320911,1.0312354899289318,1.9091613627316661,-0.39781781665065807,1.9355771876218029,0.84947374829074818,0.14511469372531849,-0.5763656758425526,0.51820448406955677,-0.50019093981960339,-1.1795026921389393,1.4851892329098888,-1.4568435811159901,0.64868048199436146,0.2249954081418224,1.860518250549049,0.20424059399387318,1.0172498560788341,0.30404642590305286,0.19862154492160755,0.4544265604855724,-1.415355887329369,1.7001235819699474,0.22659376629611927,1.0037696696164318,0.38775900372287708,0.5496728754880138,1.1818540430905529,0.10436132916233021,0.13660696514865833,-1.8048956059572987,-1.3179876469729237,-0.018297400390892449,-0.69483586779811901,2.0184228754880138,-1.1540395878908924,1.2366178370358654,0.17069986828586536,-1.2220956944582753,-0.85850640765407604,-1.0919668339846424,-1.2092430256960682,0.081168923461646614,-1.1251194142458729,-0.21564027301052135,-0.97560235491970104,0.23824766644260365,0.066228661620826301,0.58862093457004505,1.1039436198117443,-0.26529523364284557,-0.19086190692165417,0.58079317578098255,-0.54335328570583385,1.8305461741330333,0.70370081433078724,1.0117910242917247,1.2431743479611583,0.25210836895725208,-1.3142912053225331,-1.0513794087527089,-1.0595390462038807,-1.2964965962527089,-0.38169690600612682,-0.09297105303981823,1.9333522654416271,-0.28154679766872448,0.79645040997287708,0.78094366558811146,0.11186197766086536,1.1339691019894786,1.8179700709225841,1.0880506373288341,2.1009700632931896,-0.99774285784938854,-0.9024917744753651,-1.4188882969973378,0.56149366863986927,0.6179397440793224,0.26417616375705677,0.71680048474094349,1.1120241022946544,0.54622534283420521,0.10063818463108021,-1.2747070454714589,-0.19467660418727917,-0.35358544818141979,1.3030088282468029,1.3843095637204357,-1.5059911870119862,0.10402849682590443,0.34659079083225208,1.4272373057248302,-0.71875783435085339,1.4636953211667247,-1.5154993199465565,0.21730211743137318,-0.29521581164577526,0.75454882153293568,0.77738550671359974,0.030566964233130989,0.82854345806858021,0.072750840270728645,0.46265772351047474,-0.10909768573024792,0.28167894848606068,-0.26892682543972057,-1.0653555058596424,-0.010384764587669792,-0.52870007983425182,0.19275263317844349,0.53497293957492786,1.984917435729713,-0.72100183001735729,-1.6004879140017323,-0.21774598590114635,0.8057916499020763,-0.94099256030300182,-0.85765668383815807,-0.57124063006618542,-0.5596725606081776,-0.020803656494408074,-1.2380516194460682,0.23572805889865833,-0.83270093432643932,-0.20165750018337292,0.24650839337131458,0.45604208477756458,0.33566359051486927,0.74270800122043568,0.22717932232639271,-0.6091415547488026,0.045300278747291145,-0.87871190539577526,-0.7837783955691151,0.12437227734348255,0.79563597210666615,0.073034081542701301,-0.51198121539333385,0.72189405926486927,-1.1880180501101307,-0.063472952759056511,0.40331438549777943,-0.48596593371608776,-0.63630696765163464,0.98403719433567005],"y":[0.74214978908237672,1.5186767170303748,0.20609398578342653,0.71839042400058961,-1.0663440635329797,-1.3951688220626428,-0.023368876231343982,0.4369406292313025,-1.0473325660354211,0.28752799724277711,-0.53527859951320433,1.1573714802139685,1.2291478702896521,-0.32868794704738402,-0.38193372989955687,-0.24373988415065551,0.64207025264438844,-0.087782423747213123,-0.33048037792506957,-0.39183310772243285,-0.29479054714504027,-0.14523200298610472,0.74539752696689821,-1.0066008975631311,-0.31734422947231078,1.3263215610855505,-0.048652928126485584,0.28369136546787477,-1.1076431682235315,1.0093216488235877,-0.7403664996749475,0.9473461696976111,0.87324138377842164,0.52899928783115602,0.61541553233799196,0.87369437907871461,0.64191432689365602,1.1597451755875037,0.60230966304477906,0.21125694011387086,0.73519225810703492,-1.0249247958785608,0.17672963832554078,-0.25129536892238402,1.6869697162979529,0.64436145518955446,0.26789684985813356,0.032632310139505627,-0.039248507273824451,1.0960259029739783,1.1979908535355017,-0.78312091137233519,-1.0805216243392541,0.22908802722629762,0.099212844120828869,-0.23995165134731078,-0.65676478649440551,-0.24801759029689574,0.76845880244907594,1.797028023945658,1.0964779445999548,0.58819528316196656,1.291236836659281,1.3361601421707556,0.13413735126194215,-1.5132196357375696,1.1282672474258826,-0.22926906849208617,0.090128619419901135,0.68224712108310914,0.069889266239969494,0.22191544269260621,-0.51150230671230101,-0.26327900196376586,1.2508849689834998,1.4494890758865759,-0.23669413830104613,-0.44309596325221801,-0.067254584086568592,0.38547893260654664,1.0716394970291541,-0.9299571921950891,-0.88224415088954711,-0.80827025677028441,0.58882947658237672,0.37843127940830446,0.0177661964767859,0.78196998332676149,-0.7593796661025598,-0.66004709507289672,0.47732873653110719,1.4884166309708045,0.79583450053867555,0.90144677852329469,-0.29121927524867797,-0.47618321682277465,-1.2217574527389123,1.0583543369644568,-0.047045033229024646,0.80607171748813844,0.91380592082676149,0.63646836970981813,-0.68035487438503051,-0.30761460567775512,1.1214851925247595,1.2050966808670447,-0.67459944988551879,-1.2472451141006067,0.68558116649326539,0.43820567821201539,0.75934501384433961,0.13342138026890016,-0.32526163364711547,-1.2513809611922815,0.015438277470438244,1.1810383388870642,-0.36297921444240355,-0.22293977047267699,-0.16823319698634887,-0.092472594035299061,-0.19796447063747191,0.9070934841507361,-0.97473506237331176,-1.4363127162581995,-1.1507509162551477,0.71247716640171266,0.91686244701084352,1.6647228786819861,0.56130691264805055,0.27139182780918336,0.90366359447178102,-1.1380455901748254,-1.2076001575118616,-0.66086367870631957,-0.2525737693435266,0.0092088768356726192,0.98625465129551149,0.30663820003208375,-0.30420712734523558,0.087970931279031994,-0.64012173916164183,0.77176089976963258,0.11422773097690797,-0.44404653812709594,-0.42487267757716918,-0.50920466686549926,-1.1098394801742151,0.77576442454990602,-1.2238724639541223,-0.062146704447896717,-1.5184698512679651,0.75694986079868531,-0.011381666911275623,0.63179918025669313,-0.63343004490199828,0.13413186763462281,-0.30611519123378539,-0.38073472286525512,0.99770780299839235,-0.50829414631191039,-0.75499514843288207,-0.82334188724818969,1.3066939899795935,0.16282315944370485,0.69907613490757203,-0.72056845928493285,0.69650169109043336,1.161313969837992,0.32734938358005738,0.89286466334995485,-0.25768951679530883,1.6910895893448279,1.0660366604202673,-0.26748923565212035,0.16301151012119508,-0.53747586513820433,-0.46202401424709105,-0.34839300419154906,0.27579446529087281,1.1083783695572302,0.23858376239475465,-0.9229078700667932,-0.30775694156947875,0.46755357478794313,1.7986034939163611,-0.67168382908168578,1.0350584576004431,-0.66408662105861449,-0.54998592640224242,-1.1556055953628137,-0.28991917873683715,-0.43327025677028441,-1.1111236026412561,-0.76548747326198363,-1.2672839572555139,1.0359997341507361,0.70425124858555055,0.55294128154453492,-0.84221486355129027,-0.23272899891200804,-0.43940333629909301,0.15111656879123903,0.50795121883091188,-0.47565392757716918,-0.33781270290675902,-0.62387661243739867,-1.0389793326980188,0.55719085429844117,0.70784135554966188,0.68173738216099,0.17037530635532594,-1.1401820590621545,0.95664020274814821,0.31140251849827028,1.0778684208267615,0.086435754048197033,-0.84668521190944457,-1.631868403208883,-0.13952736164394164,-0.94029764438930297,-0.14285187031093383,-0.75791243816676879,-0.47391633297267699,1.2603125164383338,0.60691781734165406,-0.4524491241103723,-1.3728325774795129,-0.26179889942470336,-0.76865081096950316,0.46776672099765992,-1.6837234904891565,0.49434514735874391,0.94422383998569703,0.75196023677524781,-1.4201901366836145,-0.0030608585006310918,-0.91812090183559203,0.87745996211704469,-0.85255674625697875,-0.12379459644618773,0.092456538426248791,-0.83755378032985472,-0.15412883068385863,1.4597377369278357,0.63435741161045289,0.78973718379673219,0.87757011150058961,0.54915567134556031,-0.0031137874251916386,-1.5915313174850061,0.96082778667148805,0.22880883907016969,-0.44353298450771117,1.0367192814224646,0.219548661457865,0.80065675471958375,-0.41052893902126097,-0.43110684658351683,1.2399611065262244,-1.5162804534560754,0.33002610896763063,-1.2384126594192102,0.61278863643345094,-0.79466943050685668,1.2036327907913611,-0.88083748127284789,-0.33454708362880492,0.23230977748569703,0.81722779964145875,-0.86268047596278929,-0.63858536983791137,-0.55182103420558715,-1.1632569244033411,-0.23930029178920531,1.2490672657364295,0.74674411510166383,0.054032761799661877,1.471600491749613,0.23029299472507692,0.028339345204202893,-0.5470526626235559,0.67660756801304078,-0.82518581653896117,0.15781326984104371,1.0437793323868201,-1.3074706008559778,0.28043003772434449,-0.56955675388637328,-0.41408590580287719,-0.14481333996120238,-1.1380880286819055,-0.11667684818568969,-0.68036035801234984,-0.98363880420985961,0.50544400905307985,-1.3638122489577844,0.77549691890415406,0.54210897182163453,-0.34064678455653929,-1.1485579421645715,0.62425418590244508,1.1693362781876013,0.10007997249302125,-0.5118048598891809,-0.4287512710219934,-1.4063959529525354,-0.093794863474996326,-1.1019146850234582,1.2672886440628455,0.011132914769022229,1.7697190830582068,0.0038206169479773067,-0.70670775677028441,-0.26818589474025512,0.80196519588169313,-1.5745306422835901,0.40040775035557008,-0.16733078266444945,0.067147929417459729,-0.68756441379848265,1.1768259594314978,0.619939286457865,0.57702823375400758,-0.38804821277919554,-0.52295402790370726,1.0961937496536658,-1.6189890315658166,0.32323427890476442,0.54767890666660524,1.0471405575149939,-0.2758131435042932,0.41778655742344117,1.2827953884476111,-0.28006891514125609,-0.79872111584010863,0.011137206303446057,0.14657850955661988,-0.26860360409084105,0.89436574672397828,-1.6098578384048059,-1.4369399955398157,-0.92526296879115844,0.66551585887607789,0.085258443104593518,-0.051411431086690662,0.92088981364902711,-0.78687361980739379,-1.532873909724386,-0.92340878750148558,0.40879150127109742,1.484711129414408,0.95925708507236696,1.1226167271011755,-1.4013171603805139,-0.45108036304775023,-1.0922232082015588,-0.14215473438564086,0.94008155559238649,0.20357914661106324,-1.0421429088241174,0.18033214305576539,-0.31578258777919554,1.3260068485611365,0.84662099574741578,-0.10312608982387328,0.40056224559482789,0.86815496181186891,0.30273719524082399,-0.92978624607387328,0.49201961253818727,0.00083657001194215042,-0.12347106243434691,0.31109781955417848,-0.95125440861049437,0.70419688914951539,0.52624507640537477,0.32560225223240113,0.4545483181351111,0.54439397548374391,0.91692777370151735,0.16004486774143434,-0.035002987635762928,-1.1235020568496301,0.79462857936557985,-0.10287932659450316,0.3347367832535193,-0.57865671421352172,0.16381521915134645,0.25783105586704469,-0.67494110370937133,0.58262582515415406,-0.51403121258083129,0.61390491222080446,0.29989524577793336,-0.14721683765712523,-0.35186676288905883,-0.85775856281581664,0.12845941280063844,0.71638532375034547,-0.99583319927516722,-0.30652598644557738,-0.23793701435390258,0.026170212971536877,0.17249699329075074,0.18614598010715699,1.0383848736160681,-0.56834320331874633,-0.22677616382900023,-0.24121836925807738,0.79207225536045289],"z":[1.0351552346296478,0.37752431421949151,0.7079824784345794,0.57645982294751885,0.92299836664869073,0.52102273493482354,0.22868722468091729,0.4895529130048919,0.59307044535352471,-0.067314209645254586,0.80752509623243096,-0.63473612279222724,-0.3734832426957917,1.0525130608625579,0.27575248270704034,-0.1322580000810456,0.86245006113721612,-0.64797646016405341,-0.8965850493364167,1.2397579529829192,-0.040606560414297554,-1.1622100493364167,1.1555895188398528,0.49790376215650323,0.28961890726758721,0.43318360834790948,-1.1441431662492585,1.217744765574472,-0.21373516530321357,0.033835826212899711,1.1020683625288177,-0.74346739262865302,1.2017239907331634,0.78690570383741143,1.5495457032270599,-0.050571026509268258,0.99270671396924737,1.1743420937605071,-0.13918978184984443,-0.09608990163133857,1.5109285691328216,-0.10596424550340888,1.5707425454206634,-1.4228363654069733,0.39808076410962823,-0.14526754826830146,0.65815919428540948,-0.9248905798845124,-1.669483246510489,0.1694697716779876,1.2705735543317962,1.0070199349470306,0.072916922862069633,-0.0023480078630280232,0.59303945093824151,1.226200518900888,-1.2512331625871491,-1.2253361365251374,0.65402501612378838,0.60544532328321221,0.16641229181958916,0.099568782145516899,-0.0083528181962799763,1.343690810496347,0.59602016001416924,0.48394387751294854,-0.94197803944872138,-0.53430658788011787,1.2521995881147552,1.6254109719343353,1.2519344666547942,-0.65913444966600654,-0.089760365193350289,-1.8316507956437897,-0.16389042348192451,-0.47231966466234443,0.086555896098153617,-1.3482471129350495,-0.061593117421133492,-1.2913151404313874,0.88342946558667901,-0.83992630452440498,-1.2073498389177155,1.0943841317243743,-1.0042791983537507,1.1968764641828704,-1.0519161841325593,1.5503920891828704,-0.12366110295580146,-0.37948900670336005,1.015596328074472,0.61982816248609307,0.11673921137525323,0.88826840906812432,0.72871631174756768,1.5490135529585052,0.86388724833204034,-0.22723585576341865,0.21066325693799737,-0.034850182240469429,0.23253959208204034,1.7283143380232024,-0.014862599080069039,-1.4628048560075593,-0.094454827015860054,0.84350722819043877,1.4736561158247161,-0.010380329792959664,1.5224689820356536,-1.2262030264787507,-0.81098991841600654,0.83310597925855401,0.75976508646680596,0.043122229868905571,-1.5001702925615144,0.79423278361036065,1.0397614815778899,-1.9126201292924714,1.4397153237409759,-0.63962179631517646,-1.0113306662492585,1.0327739098615814,1.262976584727304,0.3045253136701751,-0.29222208470628974,-0.60247379750536201,0.96738427668287041,0.27142232447339776,1.069621978098886,0.79766267328931573,0.5423187592573333,0.77302497416211846,0.69072049647046807,-0.35301500767992255,0.48993152170850518,1.129675803477304,1.0737857201643157,-0.71121269673631904,0.45460837870313409,0.4382991173811126,0.75706189661695245,0.78684514551831963,-1.5369687697343659,0.60610288172437432,-0.20584589452074287,0.61863320856763604,-1.276757301991446,-0.48645502538011787,-0.76399284810350654,-1.1342092177324128,-0.6866555830888581,-1.0345521590165925,-0.2112379691057038,0.0026182511396575237,-0.75573927373216865,0.33275168925000909,-0.52156025380419013,-0.97183472127245185,0.51139062433912041,-0.73998600453661201,-1.0712533614091706,0.57446282892896416,0.22986930399610284,0.38867610483838799,0.087613520915048149,-1.1738153120927644,0.93597262888623955,1.354320464427011,1.4013671258039642,1.3329285958357024,0.94953435450269463,0.88419335871412041,-1.1644073149614167,-1.1912108084611726,0.13259166269971612,-0.039110245411856148,1.0883473733015228,0.37532323389722588,1.0366882660932708,0.18922608881665948,-0.49139934987352607,-1.1598239561967683,0.45468944102002862,0.21360200434400323,0.71169179468824151,0.12290948420240166,0.46228259592725518,-1.5940366408281159,-1.7993226668290925,-0.15824181050585029,0.42558043986036065,0.4958242753095794,-0.73313528508470771,0.52218097239209893,-1.2284074446611237,-0.43188435048387763,0.71809094935132745,-0.042710365956289742,-0.13413959950731513,-0.56524378270433662,-1.1541338583879304,-0.025728287404043648,-0.84715038747118232,-1.8499003073625397,-0.069375099843008492,-0.84789806813524482,-0.87345606297777412,-0.21590477437303779,-0.95991903752611396,-0.38542610616014716,0.16455930262281182,-0.64503532857225654,-0.80449682683275459,-0.78312546223924873,-0.63980156392381904,-1.3613043448381257,0.5070404389448333,-0.33255487889574287,0.80330174952222588,0.93647330790235284,0.58463233500196221,0.99391025095655205,-0.39790445775316474,1.0951661446638274,1.3117594101972747,-1.2987995764665436,-0.90348535985277412,-2.0481086394243073,0.40143579035474541,0.057485995585458305,-0.70530754536913154,-0.8099461218766999,-0.74501568288133857,-0.49166637868211982,-1.4479933401994538,0.88957637339307549,-0.8854771277360749,0.089286265666024711,-1.2786684653215241,-0.35097032994554755,-1.039330544178946,0.19012778788282159,-1.794147553151114,0.45779078989698174,-0.55528742284105537,0.77602046518995049,-0.070068421071035836,-0.64831644505785224,-0.62653118581102607,-0.46838146657274482,-0.29513412923143623,0.86731284647657159,-0.32132679433153388,-0.96601683110521552,0.58119529276563409,0.032402453715341117,-0.24017387837694404,-2.0617166182451081,0.3234767296858001,-0.74709898442552802,0.017320571238534477,0.49932282953931573,0.014702735239999321,-1.0120363852433991,-0.72903543919847724,0.95982688456250909,-0.27581507176683662,1.5045718529768157,0.76268332987500909,0.35324233561231377,-1.8527665755204987,1.2127999642439056,-0.22168451756761787,-1.3694925925187897,0.16276544123365166,1.0046266892500091,0.45702975779248955,0.43939441233350518,-1.1824679991655183,0.3067983964033294,0.31161492853833916,-0.35344702214525459,0.95811503916455987,-1.4670668265275788,0.98371308832837823,-1.186944069569571,0.95601886301709893,-1.7707324644975495,-0.74367624730394599,-1.7520599982194733,-1.0402188918046784,-0.12614828557298896,-1.2410216948442292,-0.89217430562303779,-0.42979008168504951,0.13986390619947198,-0.93780142278002021,0.21133655100538018,0.039298949534432914,-0.65363031834886787,-0.83833891362474677,-0.63714224309252021,-0.79297167271898505,-1.5744276663713288,-0.45706278294847724,-1.279346527760489,-0.65330130070970771,0.19710439234449151,1.1746506074018646,-1.7209220549516511,0.54592889338208916,1.726756987864511,-1.6291628500871491,-0.87918907613085029,-0.77426821202562568,0.0026649811811614299,0.58020061045362237,1.3728231766767669,0.67072289972974541,0.86697238474561455,1.1077117302961517,1.2029146531171966,0.11051505594922784,-0.071982922261221383,-0.70664602727220771,0.2204040864057708,-0.47670084447191474,0.075461325938241508,1.6602525094099212,0.24645703821851495,-1.7483535429887604,-1.0256095549516511,-0.5278411528520417,-0.27105814427660224,-0.50450092763231513,-0.30351788014696357,0.78425305872632745,0.42014592676831963,0.75773614435865166,-0.58392769307420966,-1.1555328986100983,0.97725862055494073,-0.76971250981615302,0.73359721689893487,-1.054319443409903,1.4708017685957122,-0.13229900807665107,-0.43590933293627021,-0.13283163518236396,0.75318711786939385,0.68462461023999932,0.32772916346265557,0.56707709818555596,-0.75147921056078193,1.5460085251875091,1.0933374741621185,-0.64937168568895576,0.29583734064771416,0.067456660563485649,0.1384934762067962,1.6700567582197356,-1.4664197585038972,0.30312770395948174,0.61086791544629815,1.0088528969831634,-0.32816654652879951,0.035215316111581352,0.61779397516919854,0.51545089274122002,0.79477828531934502,0.71074145823194268,1.1049126961774993,1.1270150521345306,-0.88597732991502998,0.69723313837720635,0.44024556666089776,0.4653987267561126,0.24551147013379815,0.23506253748609307,1.3127426484174896,0.68613761454297784,1.0821184495039153,0.1747030594892669,-0.97280508488939521,0.3029226639814544,1.049806533152597,0.27420323878003838,0.1252350190229583,-0.19470030278490302,1.3924106934614349,-0.23135239095018623,1.0585598328657317,1.4797105172224212,-1.2816024443559479,0.57914060145093682,0.70045608072950127,0.90802997141553643,-0.55490786046312568,0.64848083048536065,-0.04014355153368232,1.19757979899122,-1.7921329161577058,1.4585127213545013,-0.39728552312181709,0.59537833719922784,0.89679378061963799,1.5380725243635345,1.0966028550214935,1.0291942933149505,0.94762366800977471],"mode":"markers","type":"scatter3d","name":"MS","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="session-info" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Session Info</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Session info 
 setting  value
 version  R version 4.3.3 (2024-02-29 ucrt)
 os       Windows 11 x64 (build 22631)
 system   x86_64, mingw32
 ui       RTerm
 language (EN)
 collate  English_United Kingdom.utf8
 ctype    English_United Kingdom.utf8
 tz       Europe/Copenhagen
 date     2024-05-24
 pandoc   3.1.11 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)

 Packages 
 package      * version    date (UTC) lib source
 backports      1.4.1      2021-12-13 [1] CRAN (R 4.3.1)
 broom        * 1.0.5      2023-06-09 [1] CRAN (R 4.3.3)
 cachem         1.0.8      2023-05-01 [1] CRAN (R 4.3.3)
 class          7.3-22     2023-05-03 [2] CRAN (R 4.3.3)
 cli            3.6.2      2023-12-11 [1] CRAN (R 4.3.3)
 codetools      0.2-19     2023-02-01 [2] CRAN (R 4.3.3)
 colorspace     2.1-0      2023-01-23 [1] CRAN (R 4.3.3)
 conflicted     1.2.0      2023-02-01 [1] CRAN (R 4.3.3)
 crosstalk      1.2.1      2023-11-23 [1] CRAN (R 4.3.3)
 data.table     1.15.4     2024-03-30 [1] CRAN (R 4.3.3)
 dials        * 1.2.1      2024-02-22 [1] CRAN (R 4.3.3)
 DiceDesign     1.10       2023-12-07 [1] CRAN (R 4.3.3)
 digest         0.6.35     2024-03-11 [1] CRAN (R 4.3.3)
 dplyr        * 1.1.4      2023-11-17 [1] CRAN (R 4.3.2)
 evaluate       0.23       2023-11-01 [1] CRAN (R 4.3.3)
 fansi          1.0.6      2023-12-08 [1] CRAN (R 4.3.3)
 farver         2.1.1      2022-07-06 [1] CRAN (R 4.3.3)
 fastmap        1.1.1      2023-02-24 [1] CRAN (R 4.3.3)
 FNN            1.1.4      2024-01-12 [1] CRAN (R 4.3.3)
 foreach        1.5.2      2022-02-02 [1] CRAN (R 4.3.3)
 furrr          0.3.1      2022-08-15 [1] CRAN (R 4.3.3)
 future         1.33.2     2024-03-26 [1] CRAN (R 4.3.3)
 future.apply   1.11.2     2024-03-28 [1] CRAN (R 4.3.3)
 generics       0.1.3      2022-07-05 [1] CRAN (R 4.3.3)
 ggplot2      * 3.5.1      2024-04-23 [1] CRAN (R 4.3.3)
 globals        0.16.3     2024-03-08 [1] CRAN (R 4.3.3)
 glue           1.7.0      2024-01-09 [1] CRAN (R 4.3.3)
 gower          1.0.1      2022-12-22 [1] CRAN (R 4.3.1)
 GPfit          1.0-8      2019-02-08 [1] CRAN (R 4.3.3)
 gtable         0.3.5      2024-04-22 [1] CRAN (R 4.3.3)
 hardhat        1.3.1      2024-02-02 [1] CRAN (R 4.3.3)
 hms            1.1.3      2023-03-21 [1] CRAN (R 4.3.3)
 htmltools      0.5.8.1    2024-04-04 [1] CRAN (R 4.3.3)
 htmlwidgets    1.6.4      2023-12-06 [1] CRAN (R 4.3.3)
 httr           1.4.7      2023-08-15 [1] CRAN (R 4.3.3)
 infer        * 1.0.7      2024-03-25 [1] CRAN (R 4.3.3)
 ipred          0.9-14     2023-03-09 [1] CRAN (R 4.3.3)
 irlba          2.3.5.1    2022-10-03 [1] CRAN (R 4.3.3)
 iterators      1.0.14     2022-02-05 [1] CRAN (R 4.3.3)
 jsonlite       1.8.8      2023-12-04 [1] CRAN (R 4.3.3)
 knitr          1.46       2024-04-06 [1] CRAN (R 4.3.3)
 labeling       0.4.3      2023-08-29 [1] CRAN (R 4.3.1)
 lattice        0.22-5     2023-10-24 [2] CRAN (R 4.3.3)
 lava           1.8.0      2024-03-05 [1] CRAN (R 4.3.3)
 lazyeval       0.2.2      2019-03-15 [1] CRAN (R 4.3.3)
 lhs            1.1.6      2022-12-17 [1] CRAN (R 4.3.3)
 lifecycle      1.0.4      2023-11-07 [1] CRAN (R 4.3.3)
 listenv        0.9.1      2024-01-29 [1] CRAN (R 4.3.3)
 lubridate      1.9.3      2023-09-27 [1] CRAN (R 4.3.3)
 magrittr       2.0.3      2022-03-30 [1] CRAN (R 4.3.3)
 MASS           7.3-60.0.1 2024-01-13 [2] CRAN (R 4.3.3)
 Matrix       * 1.6-5      2024-01-11 [2] CRAN (R 4.3.3)
 memoise        2.0.1      2021-11-26 [1] CRAN (R 4.3.3)
 modeldata    * 1.3.0      2024-01-21 [1] CRAN (R 4.3.3)
 munsell        0.5.1      2024-04-01 [1] CRAN (R 4.3.3)
 nnet           7.3-19     2023-05-03 [2] CRAN (R 4.3.3)
 parallelly     1.37.1     2024-02-29 [1] CRAN (R 4.3.3)
 parsnip      * 1.2.1      2024-03-22 [1] CRAN (R 4.3.3)
 pillar         1.9.0      2023-03-22 [1] CRAN (R 4.3.3)
 pkgconfig      2.0.3      2019-09-22 [1] CRAN (R 4.3.3)
 plotly         4.10.4     2024-01-13 [1] CRAN (R 4.3.3)
 prodlim        2023.08.28 2023-08-28 [1] CRAN (R 4.3.3)
 purrr        * 1.0.2      2023-08-10 [1] CRAN (R 4.3.3)
 R6             2.5.1      2021-08-19 [1] CRAN (R 4.3.3)
 RColorBrewer   1.1-3      2022-04-03 [1] CRAN (R 4.3.1)
 Rcpp           1.0.12     2024-01-09 [1] CRAN (R 4.3.3)
 readr          2.1.5      2024-01-10 [1] CRAN (R 4.3.3)
 recipes      * 1.0.10     2024-02-18 [1] CRAN (R 4.3.3)
 rlang          1.1.3      2024-01-10 [1] CRAN (R 4.3.3)
 rmarkdown      2.26       2024-03-05 [1] CRAN (R 4.3.3)
 rpart          4.1.23     2023-12-05 [2] CRAN (R 4.3.3)
 rsample      * 1.2.1      2024-03-25 [1] CRAN (R 4.3.3)
 rstudioapi     0.16.0     2024-03-24 [1] CRAN (R 4.3.3)
 scales       * 1.3.0      2023-11-28 [1] CRAN (R 4.3.3)
 sessioninfo    1.2.2      2021-12-06 [1] CRAN (R 4.3.3)
 survival       3.5-8      2024-02-14 [2] CRAN (R 4.3.3)
 tibble       * 3.2.1      2023-03-20 [1] CRAN (R 4.3.3)
 tidymodels   * 1.2.0      2024-03-25 [1] CRAN (R 4.3.3)
 tidyr        * 1.3.1      2024-01-24 [1] CRAN (R 4.3.3)
 tidyselect     1.2.1      2024-03-11 [1] CRAN (R 4.3.3)
 timechange     0.3.0      2024-01-18 [1] CRAN (R 4.3.3)
 timeDate       4032.109   2023-12-14 [1] CRAN (R 4.3.2)
 tune         * 1.2.1      2024-04-18 [1] CRAN (R 4.3.3)
 tzdb           0.4.0      2023-05-12 [1] CRAN (R 4.3.3)
 utf8           1.2.4      2023-10-22 [1] CRAN (R 4.3.3)
 uwot         * 0.2.2      2024-04-21 [1] CRAN (R 4.3.3)
 vctrs          0.6.5      2023-12-01 [1] CRAN (R 4.3.3)
 viridisLite    0.4.2      2023-05-02 [1] CRAN (R 4.3.3)
 withr          3.0.0      2024-01-16 [1] CRAN (R 4.3.3)
 workflows    * 1.1.4      2024-02-19 [1] CRAN (R 4.3.3)
 workflowsets * 1.1.0      2024-03-21 [1] CRAN (R 4.3.3)
 xfun           0.43       2024-03-25 [1] CRAN (R 4.3.3)
 yaml           2.3.8      2023-12-11 [1] CRAN (R 4.3.2)
 yardstick    * 1.3.1      2024-03-21 [1] CRAN (R 4.3.3)

 [1] C:/Users/Willi/AppData/Local/R/win-library/4.3
 [2] C:/Program Files/R/R-4.3.3/library

</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./pre01_pca.html" class="pagination-link" aria-label="Principal Component Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Principal Component Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./apply00_intro.html" class="pagination-link" aria-label="Modeling of Microbiome Data">
        <span class="nav-page-text">Modeling of Microbiome Data</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>